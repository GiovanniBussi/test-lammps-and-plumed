#! /bin/bash

set -e
set -x

cd "$(mktemp -dt lammps.XXXXXX)"

git clone git://github.com/lammps/lammps.git
cd lammps

if [ -n "$1" ] ; then
  echo "installing lammps $version"
  version=$1
else
  echo "installing latest stable lammps"
  version=$(git tag --sort=-creatordate | grep stable | head -n 1)
fi

git checkout $version

cd src
make yes-kspace
make yes-molecule
make yes-rigid
make -j 5 ubuntu_simple
cp ./lmp_ubuntu_simple $HOME/opt/bin/lammps

